import{api as r}from"./sinuous.js";let n="nextSibling";let t=0;function o(n,o,e){let f;return"string"==typeof o?o=document.createTextNode(o):o instanceof Node||(o=r.h([],o)),11===o.nodeType&&(f=o.firstChild)&&f!==o.lastChild&&(f.t=o.lastChild.t=++t),n.insertBefore(o,e),f||o}function e(r,n,t){let o=r.t;if(o)for(r=r[n];r&&r.t!==o;)r=r[n];return t?r:r[n]}function f(r,n,t){let o;for(;n!==t;)o=n.nextSibling,r.removeChild(n),n=o}function u(r,n,t,o){let e;for(;n!==t;)e=n.nextSibling,r.insertBefore(n,o),n=e}function i(r,n){let t=-1,o=r.length;if(o>0&&r[o-1]<=n)return o-1;for(;o-t>1;){var e=(t+o)/2|0;r[e]>n?o=e:t=e}return t}function c(n,t,e){const{subscribe:f,root:u,sample:i,cleanup:c}=r;null==e&&(e=!t.$t);let s=document.createDocumentFragment();let a=o(s,""),p=o(s,""),b=new Map;function v(){b.forEach((r=>r())),b.clear()}function m(r){let n=b.get(r);n&&n(),b.delete(r)}function g(r,n,f,i,c){return e?u((e=>{let u=o(r,t(n,f,i),c);return b.set(u,e),u})):o(r,t(n,f,i),c)}return c(f((r=>{let t=n();return i((()=>l(r||[],t||[],a,p,g,e&&v,e&&m)))}))),c(v),s}function l(r,t,o,c,s,a,p){let b=c.parentNode;let v,m=t.length;if(0===m){let r=o.previousSibling;return r&&r.previousSibling||c.nextSibling?f(b,o.nextSibling,c):(b.textContent="",r&&b.appendChild(r),b.appendChild(o),b.appendChild(c)),a&&a(),[]}if(0===r.length){for(v=0;v<m;v++)s(b,t[v],v,t,c);return t.slice()}let g,w,d=0,k=0,y=r.length-1,S=m-1,x=o.nextSibling,A=c.previousSibling,M=c;r:for(;;){for(;r[d]===t[k];)if(k++,x=e(x,n),y<++d||S<k)break r;for(;r[y]===t[S];)if(S--,M=e(A,"previousSibling",!0),A=M.previousSibling,--y<d||S<k)break r;break}if(S<k){for(;d<=y--;)g=e(A,"previousSibling",!0),w=g.previousSibling,f(b,g,A.nextSibling),p&&p(g),A=w;return t.slice()}if(y<d){for(;k<=S;)s(b,t[k++],k,t,M);return t.slice()}const N=new Array(S+1-k),h=new Map;for(v=k;v<=S;v++)N[v]=-1,h.set(t[v],v);m=0;let j=[];for(v=d;v<=y;v++)g=h.get(r[v]),g?(N[g]=v,m++):j.push(v);if(0===m)return l(l(r,[],o,c,s,a),t,o,c,s);let q=[];for(g=x,v=d;v<=y;v++)q[v]=g,g=e(g,n);for(v=0;v<j.length;v++)g=q[j[v]],f(b,g,e(g,n)),p&&p(g);let z=function(r,n){let t=[],o=[],e=-1,f=new Array(r.length);for(var u=n,c=r.length;u<c;u++){var l=r[u];if(!(l<0)){var s=i(t,l);-1!==s&&(f[u]=o[s]),s===e?(e++,t[e]=l,o[e]=u):l<t[s+1]&&(t[s+1]=l,o[s+1]=u)}}for(u=o[e];e>=0;u=f[u],e--)t[e]=u;return t}(N,k);for(m=z.length-1,v=S;v>=k;v--)z[m]===v?(M=q[N[z[m]]],m--):(-1===N[v]?g=s(b,t[v],v,t,M):(g=q[N[v]],u(b,g,e(g,n),M)),M=g);return t.slice()}export{c as map};
//# sourceMappingURL=map.js.map
